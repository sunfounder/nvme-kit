.. note::

    æ‚¨å¥½ï¼Œæ¬¢è¿åŠ å…¥ SunFounder çš„ Raspberry Piã€Arduino å’Œ ESP32 çˆ±å¥½è€… Facebook ç¤¾åŒºï¼ä¸å¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·æ·±å…¥æ¢ç´¢ Raspberry Piã€Arduino å’Œ ESP32 çš„æ— é™å¯èƒ½ã€‚

    **ä¸ºä»€ä¹ˆåŠ å…¥ï¼Ÿ**

    - **ä¸“å®¶æ”¯æŒ**ï¼šåœ¨ç¤¾åŒºå’Œå®˜æ–¹å›¢é˜Ÿçš„å¸®åŠ©ä¸‹è§£å†³å”®åé—®é¢˜å’ŒæŠ€æœ¯éš¾é¢˜ã€‚
    - **å­¦ä¹ ä¸åˆ†äº«**ï¼šäº¤æµæŠ€å·§å’Œæ•™ç¨‹ï¼Œæå‡æŠ€èƒ½ã€‚
    - **ç‹¬å®¶é¢„è§ˆ**ï¼šæŠ¢å…ˆäº†è§£æ–°äº§å“å‘å¸ƒå’Œç‹¬å®¶é¢„è§ˆå†…å®¹ã€‚
    - **ä¸“å±æŠ˜æ‰£**ï¼šäº«å—æˆ‘ä»¬æœ€æ–°äº§å“çš„ä¸“å±ä¼˜æƒ ã€‚
    - **èŠ‚æ—¥ä¿ƒé”€ä¸æŠ½å¥–**ï¼šå‚ä¸èŠ‚æ—¥ç‰¹åˆ«æ´»åŠ¨å’ŒæŠ½å¥–ã€‚

    ğŸ‘‰ å‡†å¤‡å¥½ä¸€èµ·æ¢ç´¢ä¸åˆ›é€ äº†å—ï¼Ÿç‚¹å‡» [|link_sf_facebook|] ç«‹å³åŠ å…¥ï¼

.. _copy_sd_to_nvme_rpi:

å°†æ“ä½œç³»ç»Ÿä» Micro SD å¡å¤åˆ¶åˆ° NVMe SSD
==================================================================

å¦‚æœæ‚¨å·²ç»æ‹¥æœ‰ NVMe SSDï¼Œä½†æ²¡æœ‰é€‚é…å™¨å°†å…¶è¿æ¥åˆ°ç”µè„‘ï¼Œå¯ä»¥é€‰æ‹©ç¬¬ä¸‰ç§æ–¹æ³•ï¼šå…ˆå°†ç³»ç»Ÿå®‰è£…åœ¨ Micro SD å¡ä¸­ã€‚ç­‰ Raspberry Pi 5 æˆåŠŸå¯åŠ¨åï¼Œå†å°†ç³»ç»Ÿä» Micro SD å¡è¿ç§»åˆ° NVMe SSDã€‚

* é¦–å…ˆï¼Œæ‚¨éœ€è¦ :ref:`install_os_sd_rpi`ã€‚
* ç„¶åï¼Œå¯åŠ¨å¹¶ç™»å½•æ‚¨çš„ Raspberry Piã€‚å¦‚æœæ‚¨ä¸ç¡®å®šå¦‚ä½•ç™»å½•ï¼Œå¯ä»¥è®¿é—®å®˜æ–¹ Raspberry Pi ç½‘ç«™ï¼š|link_rpi_get_start|ã€‚

å®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œå†ç»§ç»­ä»¥ä¸‹æ“ä½œã€‚

1. å¯ç”¨ PCIe
--------------------

é»˜è®¤æƒ…å†µä¸‹ï¼ŒPCIe æ¥å£æ˜¯æœªå¯ç”¨çš„ã€‚

* è¦å¯ç”¨å®ƒï¼Œæ‚¨éœ€è¦æ‰“å¼€ ``/boot/firmware/config.txt`` æ–‡ä»¶ã€‚

  .. code-block:: shell
  
    sudo nano /boot/firmware/config.txt
  
* ç„¶ååœ¨æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

  .. code-block:: shell
  
    # å¯ç”¨å¤–éƒ¨ PCIe æ¥å£
    dtparam=pciex1
  
* ``pciex1`` æœ‰ä¸€ä¸ªæ›´å®¹æ˜“è®°å¿†çš„åˆ«åï¼Œæ‚¨ä¹Ÿå¯ä»¥æ·»åŠ  ``dtparam=nvme`` åˆ° ``/boot/firmware/config.txt`` æ–‡ä»¶ä¸­ã€‚

  .. code-block:: shell
  
    dtparam=nvme

* è¯¥è¿æ¥é»˜è®¤æ”¯æŒ Gen 2.0 é€Ÿåº¦ï¼ˆ5 GT/ç§’ï¼‰ï¼Œä½†æ‚¨å¯ä»¥é€šè¿‡æ·»åŠ ä»¥ä¸‹è¡Œå¼ºåˆ¶ä½¿ç”¨ Gen 3.0ï¼ˆ10 GT/ç§’ï¼‰ï¼š

  .. code-block:: shell
  
    # å¼ºåˆ¶ä½¿ç”¨ Gen 3.0 é€Ÿåº¦
    dtparam=pciex1_gen=3
  
  .. warning::

    Raspberry Pi 5 å¹¶æœªå¯¹ Gen 3.0 é€Ÿåº¦è¿›è¡Œè®¤è¯ï¼Œä½¿ç”¨è¯¥é€Ÿåº¦è¿æ¥ PCIe è®¾å¤‡å¯èƒ½ä¼šå¯¼è‡´ä¸ç¨³å®šã€‚

* æ‚¨è¿˜éœ€è¦ç¦ç”¨ PCIe å¯åŠ¨å»¶è¿Ÿï¼Œä»¥ä¾¿ Raspberry Pi åœ¨å¯åŠ¨æ—¶å¯ä»¥æ£€æµ‹åˆ° PCIe Switch åé¢çš„ NVMe é©±åŠ¨å™¨ã€‚è¯·åœ¨ ``/boot/firmware/config.txt`` æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

   .. code-block:: shell

      dtparam=pciex1_no_10s=on


* æŒ‰ä¸‹ ``Ctrl + X``ï¼Œ ``Y``ï¼Œç„¶å ``Enter`` ä¿å­˜æ›´æ”¹ã€‚



**BOOT_ORDER**

å¦‚æœæ‚¨å®‰è£…äº†ä¸¤ä¸ª NVMe ç³»ç»Ÿç›˜ï¼Œå¹¶éœ€è¦é€‰æ‹©å…¶ä¸­ä¸€ä¸ªä½œä¸ºå¯åŠ¨ç›˜ï¼Œ
å¯ä»¥ä¿®æ”¹ ``/boot/firmware/cmdline.txt`` æ–‡ä»¶ä¸­çš„ ``ROOT=PARTUUID=xxxxxxxxx`` ä¸ºæ‚¨å¸Œæœ›å¯åŠ¨çš„ç£ç›˜çš„ UUIDã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥æ‰¾ç£ç›˜çš„ UUIDï¼š

.. code-block:: shell

   ls /dev/disk/by-id/


2. åœ¨ SSD ä¸Šå®‰è£…æ“ä½œç³»ç»Ÿ
----------------------------------------

æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥åœ¨ SSD ä¸Šå®‰è£…æ“ä½œç³»ç»Ÿï¼š

**å°†ç³»ç»Ÿä» Micro SD å¡å¤åˆ¶åˆ° SSD**

#. è¿æ¥æ˜¾ç¤ºå™¨æˆ–é€šè¿‡ VNC Viewer è®¿é—® Raspberry Pi æ¡Œé¢ã€‚ç„¶åç‚¹å‡» **Raspberry Pi å›¾æ ‡** -> **é™„ä»¶ (Accessories)** -> **SD å¡å¤åˆ¶å™¨ (SD Card Copier)**ã€‚

   .. image:: img/ssd_copy.png
      

#. ç¡®ä¿æ­£ç¡®é€‰æ‹© **ä»å“ªå¤åˆ¶ï¼ˆCopy Fromï¼‰** å’Œ **å¤åˆ¶åˆ°ï¼ˆCopy Toï¼‰** çš„è®¾å¤‡ã€‚åŠ¡å¿…ä¸è¦ææ··ã€‚

   .. image:: img/ssd_copy_from.png
      

#. å‹¾é€‰ â€œNEW Partition UUIDsâ€ï¼Œç¡®ä¿ç³»ç»Ÿèƒ½æ­£ç¡®åŒºåˆ†è®¾å¤‡ï¼Œé¿å…æŒ‚è½½å†²çªå’Œå¯åŠ¨é—®é¢˜ã€‚

   .. image:: img/ssd_copy_uuid.png
   

#. é€‰æ‹©å¥½åï¼Œç‚¹å‡» **Start**ã€‚

   .. image:: img/ssd_copy_click_start.png

#. ç³»ç»Ÿä¼šæç¤º SSD ä¸Šçš„å†…å®¹å°†è¢«æ¸…é™¤ï¼Œè¯·ç¡®ä¿æå‰å¤‡ä»½æ•°æ®åå†ç‚¹å‡» Yesã€‚

   .. image:: img/ssd_copy_erase.png

#. ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œå¤åˆ¶å®Œæˆå³å¯ã€‚


**ä½¿ç”¨ Raspberry Pi Imager å®‰è£…ç³»ç»Ÿ**

å¦‚æœæ‚¨çš„ Micro SD å¡ä¸­å·²å®‰è£…æ¡Œé¢ç‰ˆç³»ç»Ÿï¼Œå¯ä»¥ä½¿ç”¨é•œåƒå·¥å…·ï¼ˆå¦‚ Raspberry Pi Imagerï¼‰å°†ç³»ç»Ÿçƒ§å½•åˆ° SSDã€‚æœ¬ä¾‹ä»¥ Raspberry Pi OS bookworm ä¸ºä¾‹ï¼Œå…¶ä»–ç³»ç»Ÿå¯èƒ½éœ€è¦å…ˆå®‰è£…é•œåƒå·¥å…·ã€‚

#. è¿æ¥æ˜¾ç¤ºå™¨æˆ–é€šè¿‡ VNC Viewer è®¿é—® Raspberry Pi æ¡Œé¢ã€‚ç„¶åç‚¹å‡» **Raspberry Pi å›¾æ ‡** -> **é™„ä»¶ (Accessories)** -> **Imager**ã€‚

   .. image:: img/ssd_imager.png

      
#. åœ¨ |link_rpi_imager| ä¸­ï¼Œç‚¹å‡» **Raspberry Pi Device**ï¼Œä»ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹© **Raspberry Pi 5** æœºå‹ã€‚

   .. image:: img/ssd_pi5.png
      :width: 90%


#. é€‰æ‹© **æ“ä½œç³»ç»Ÿï¼ˆOperating Systemï¼‰**ï¼Œæ¨èé€‰æ‹©å®˜æ–¹æ¨èçš„ç‰ˆæœ¬ã€‚

   .. image:: img/ssd_os.png
      :width: 90%
    
#. åœ¨ **å­˜å‚¨ï¼ˆStorageï¼‰** é€‰é¡¹ä¸­ï¼Œé€‰æ‹©æ‚¨æ’å…¥çš„ NVMe SSDã€‚

   .. image:: img/nvme_storage.png
      :width: 90%
    
#. ç‚¹å‡» **NEXT** ç„¶åé€‰æ‹© **EDIT SETTINGS** ä»¥è‡ªå®šä¹‰æ“ä½œç³»ç»Ÿè®¾ç½®ã€‚ 

   .. note::

      å¦‚æœæ‚¨ä¸º Raspberry Pi è¿æ¥äº†æ˜¾ç¤ºå™¨ï¼Œå¯ä»¥è·³è¿‡æ¥ä¸‹æ¥çš„è®¾ç½®ï¼Œç›´æ¥ç‚¹å‡»â€œæ˜¯ï¼ˆYesï¼‰â€å¼€å§‹å®‰è£…ï¼Œå…¶ä»–è®¾ç½®ç¨åå¯åœ¨æ˜¾ç¤ºå™¨ä¸Šå®Œæˆã€‚

   .. image:: img/os_enter_setting.png
      :width: 90%

#. è®¾ç½®ä¸€ä¸ª **ä¸»æœºåï¼ˆhostnameï¼‰** ç»™æ‚¨çš„ Raspberry Piã€‚

   .. note::

      ä¸»æœºåæ˜¯ Raspberry Pi åœ¨ç½‘ç»œä¸­çš„æ ‡è¯†ï¼Œæ‚¨å¯ä»¥é€šè¿‡ ``<hostname>.local`` æˆ– ``<hostname>.lan`` è®¿é—®å®ƒã€‚

   .. image:: img/os_set_hostname.png
      

#. åˆ›å»ºä¸€ä¸ª **ç”¨æˆ·åå’Œå¯†ç **ï¼Œç”¨äº Raspberry Pi çš„ç®¡ç†å‘˜è´¦æˆ·ã€‚

   .. note::

      è®¾ç½®å”¯ä¸€çš„ç”¨æˆ·åå’Œå¯†ç å¯¹äºä¿æŠ¤æ‚¨çš„ Raspberry Pi è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒæ²¡æœ‰é»˜è®¤å¯†ç ã€‚

   .. image:: img/os_set_username.png
      

#. é…ç½®æ— çº¿ç½‘ç»œï¼Œå¡«å†™æ‚¨çš„ **SSIDï¼ˆæ— çº¿ç½‘ç»œåï¼‰** å’Œ **å¯†ç **ã€‚

   .. note::

      è¯·å°† ``Wireless LAN country`` è®¾ç½®ä¸ºæ‚¨æ‰€åœ¨å›½å®¶çš„ä¸¤ä½ `ISO/IEC alpha2 å›½å®¶ä»£ç  <https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2#Officially_assigned_code_elements>`_ã€‚

   .. image:: img/os_set_wifi.png

#. è‹¥éœ€è¿œç¨‹è¿æ¥ Raspberry Piï¼Œå¯åœ¨ **æœåŠ¡ï¼ˆServicesï¼‰** æ ‡ç­¾ä¸­å¯ç”¨ **SSH**ã€‚

   * ä½¿ç”¨ **å¯†ç éªŒè¯** æ—¶ï¼Œå°†ä½¿ç”¨â€œå¸¸è§„ï¼ˆGeneralï¼‰â€æ ‡ç­¾ä¸­çš„ç”¨æˆ·åå’Œå¯†ç ã€‚
   * è‹¥ä½¿ç”¨ **å…¬é’¥éªŒè¯**ï¼Œè¯·é€‰æ‹© "ä»…å…è®¸å…¬é’¥éªŒè¯ï¼ˆAllow public-key authentication onlyï¼‰"ã€‚å¦‚æœæ‚¨å·²æœ‰ RSA å¯†é’¥å°†ç›´æ¥ä½¿ç”¨ï¼›è‹¥æ²¡æœ‰ï¼Œå¯ç‚¹å‡» â€œRun SSH-keygenâ€ ç”Ÿæˆä¸€å¯¹æ–°çš„å¯†é’¥ã€‚

   .. image:: img/os_enable_ssh.png
      

#. **é€‰é¡¹ï¼ˆOptionsï¼‰** èœå•å¯é…ç½® Imager å†™å…¥å®Œæˆåçš„è¡Œä¸ºï¼Œå¦‚å®Œæˆåæ’­æ”¾æç¤ºéŸ³ã€å¼¹å‡ºè®¾å¤‡ã€å¯ç”¨é¥æµ‹ç­‰ã€‚

   .. image:: img/os_options.png
    
#. è®¾ç½®å®Œæˆåï¼Œç‚¹å‡» **ä¿å­˜ï¼ˆSaveï¼‰** ä¿å­˜è‡ªå®šä¹‰è®¾ç½®ã€‚ç„¶åç‚¹å‡» **æ˜¯ï¼ˆYesï¼‰** åº”ç”¨è¿™äº›è®¾ç½®å¹¶å¼€å§‹å†™å…¥é•œåƒã€‚

   .. image:: img/os_click_yes.png
      :width: 90%
      
#. å¦‚æœ NVMe SSD ä¸­å·²æœ‰æ•°æ®ï¼Œè¯·å…ˆå¤‡ä»½ä»¥é˜²æ•°æ®ä¸¢å¤±ã€‚å¦‚æœä¸éœ€è¦å¤‡ä»½ï¼Œå¯ç›´æ¥ç‚¹å‡» **æ˜¯ï¼ˆYesï¼‰** ç»§ç»­ã€‚

   .. image:: img/nvme_erase.png
      :width: 90%

#. å½“æ‚¨çœ‹åˆ° â€œå†™å…¥æˆåŠŸï¼ˆWrite Successfulï¼‰â€ å¼¹çª—æ—¶ï¼Œè¯´æ˜é•œåƒå·²å†™å…¥å¹¶éªŒè¯æˆåŠŸã€‚æ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨ NVMe SSD å¯åŠ¨ Raspberry Pi å•¦ï¼

   .. image:: img/nvme_install_finish.png
      :width: 90%

      

.. _configure_boot_ssd:

3. é…ç½®ä» SSD å¯åŠ¨
---------------------------------------

æœ¬èŠ‚å°†æŒ‡å¯¼æ‚¨å¦‚ä½•é…ç½® Raspberry Pi ç›´æ¥ä» NVMe SSD å¯åŠ¨ï¼Œä»è€Œæ¯”ä½¿ç”¨ SD å¡è·å¾—æ›´å¿«çš„å¯åŠ¨é€Ÿåº¦å’Œæ›´å¥½çš„æ€§èƒ½ã€‚è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

#. é¦–å…ˆï¼Œåœ¨ Raspberry Pi ä¸Šæ‰“å¼€ç»ˆç«¯ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥è¿›å…¥é…ç½®ç•Œé¢ï¼š

   .. code-block:: shell

      sudo raspi-config

#. åœ¨ ``raspi-config`` èœå•ä¸­ï¼Œä½¿ç”¨æ–¹å‘é”®å¯¼èˆªå¹¶é€‰æ‹© **é«˜çº§é€‰é¡¹ï¼ˆAdvanced Optionsï¼‰**ã€‚æŒ‰ä¸‹ ``Enter`` è¿›å…¥é«˜çº§è®¾ç½®ã€‚

   .. image:: img/nvme_open_config.png

#. åœ¨ **Advanced Options** ä¸­ï¼Œé€‰æ‹© **Boot Order** ï¼ˆå¯åŠ¨é¡ºåºï¼‰ã€‚è¯¥è®¾ç½®å…è®¸æ‚¨æŒ‡å®š Raspberry Pi æœç´¢å¯å¯åŠ¨è®¾å¤‡çš„é¡ºåºã€‚

   .. image:: img/nvme_boot_order.png

#. ç„¶åï¼Œé€‰æ‹© **NVMe/USB boot**ã€‚è¿™ä¼šå‘Šè¯‰ Raspberry Pi ä¼˜å…ˆä» USB è¿æ¥çš„ SSD æˆ– NVMe é©±åŠ¨å™¨å¯åŠ¨ï¼Œè€Œä¸æ˜¯ä» SD å¡ç­‰å…¶ä»–è®¾å¤‡å¯åŠ¨ã€‚

   .. image:: img/nvme_boot_nvme.png

#. é€‰æ‹©å¥½å¯åŠ¨é¡ºåºåï¼ŒæŒ‰ä¸‹ **Finish** é€€å‡º raspi-configã€‚æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ **Esc é”®** å…³é—­é…ç½®å·¥å…·ã€‚

   .. image:: img/nvme_boot_ok.png

#. è¦åº”ç”¨æ–°çš„å¯åŠ¨è®¾ç½®ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤é‡å¯ Raspberry Piï¼š

   .. code-block:: shell

      sudo reboot
   
   .. image:: img/nvme_boot_reboot.png

é‡å¯åï¼ŒRaspberry Pi åº”è¯¥ä¼šå°è¯•ä»æ‚¨è¿æ¥çš„ NVMe SSD å¯åŠ¨ï¼Œä¸ºç³»ç»Ÿæä¾›æ›´é«˜çš„æ€§èƒ½å’Œæ›´å¼ºçš„è€ç”¨æ€§ã€‚
